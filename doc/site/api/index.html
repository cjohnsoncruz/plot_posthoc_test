
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Plot Posthoc Test (Under Development)">
      
      
        <meta name="author" content="Carlos Johnson-Cruz">
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>API - Plot Posthoc Test</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Plot Posthoc Test" class="md-header__button md-logo" aria-label="Plot Posthoc Test" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Plot Posthoc Test
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cjohnsoncruz/plot_posthoc_test" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    plot_posthoc_test
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Plot Posthoc Test" class="md-nav__button md-logo" aria-label="Plot Posthoc Test" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Plot Posthoc Test
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cjohnsoncruz/plot_posthoc_test" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    plot_posthoc_test
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate" class="md-nav__link">
    <span class="md-ellipsis">
      plot_stat_annotate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.add_errorbar_loc_on_posthoc" class="md-nav__link">
    <span class="md-ellipsis">
      add_errorbar_loc_on_posthoc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_ax_children_types" class="md-nav__link">
    <span class="md-ellipsis">
      get_ax_children_types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_child_df_row" class="md-nav__link">
    <span class="md-ellipsis">
      get_child_df_row
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_errorbar_loc_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_errorbar_loc_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_loc_on_axis" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_loc_on_axis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_point_loc_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_point_loc_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_point_loc_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_point_loc_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_pair_stat_test_result" class="md-nav__link">
    <span class="md-ellipsis">
      get_pair_stat_test_result
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_sig_bar_x_vals" class="md-nav__link">
    <span class="md-ellipsis">
      get_sig_bar_x_vals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_sig_bar_y_vals" class="md-nav__link">
    <span class="md-ellipsis">
      get_sig_bar_y_vals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_x_ticks_as_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_x_ticks_as_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.is_val_between_range_min_max" class="md-nav__link">
    <span class="md-ellipsis">
      is_val_between_range_min_max
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.main_run_posthoc_tests_and_get_hue_loc_df" class="md-nav__link">
    <span class="md-ellipsis">
      main_run_posthoc_tests_and_get_hue_loc_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.plot_sig_bars_w_comp_df" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sig_bars_w_comp_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.plot_sig_bars_w_comp_df_tight" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sig_bars_w_comp_df_tight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.return_ax_child_line_coor" class="md-nav__link">
    <span class="md-ellipsis">
      return_ax_child_line_coor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.run_posthoc_test_on_tick_hue_groups" class="md-nav__link">
    <span class="md-ellipsis">
      run_posthoc_test_on_tick_hue_groups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.run_posthoc_tests_on_all_ax_ticks" class="md-nav__link">
    <span class="md-ellipsis">
      run_posthoc_tests_on_all_ax_ticks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cjohnsoncruz/plot_posthoc_test" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate" class="md-nav__link">
    <span class="md-ellipsis">
      plot_stat_annotate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.add_errorbar_loc_on_posthoc" class="md-nav__link">
    <span class="md-ellipsis">
      add_errorbar_loc_on_posthoc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_ax_children_types" class="md-nav__link">
    <span class="md-ellipsis">
      get_ax_children_types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_child_df_row" class="md-nav__link">
    <span class="md-ellipsis">
      get_child_df_row
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_errorbar_loc_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_errorbar_loc_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_loc_on_axis" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_loc_on_axis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_point_loc_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_point_loc_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_hue_point_loc_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_hue_point_loc_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_pair_stat_test_result" class="md-nav__link">
    <span class="md-ellipsis">
      get_pair_stat_test_result
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_sig_bar_x_vals" class="md-nav__link">
    <span class="md-ellipsis">
      get_sig_bar_x_vals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_sig_bar_y_vals" class="md-nav__link">
    <span class="md-ellipsis">
      get_sig_bar_y_vals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.get_x_ticks_as_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_x_ticks_as_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.is_val_between_range_min_max" class="md-nav__link">
    <span class="md-ellipsis">
      is_val_between_range_min_max
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.main_run_posthoc_tests_and_get_hue_loc_df" class="md-nav__link">
    <span class="md-ellipsis">
      main_run_posthoc_tests_and_get_hue_loc_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.plot_sig_bars_w_comp_df" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sig_bars_w_comp_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.plot_sig_bars_w_comp_df_tight" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sig_bars_w_comp_df_tight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.return_ax_child_line_coor" class="md-nav__link">
    <span class="md-ellipsis">
      return_ax_child_line_coor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.run_posthoc_test_on_tick_hue_groups" class="md-nav__link">
    <span class="md-ellipsis">
      run_posthoc_test_on_tick_hue_groups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot_posthoc_test.plot_stat_annotate.run_posthoc_tests_on_all_ax_ticks" class="md-nav__link">
    <span class="md-ellipsis">
      run_posthoc_tests_on_all_ax_ticks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-documentation">API Documentation</h1>


<div class="doc doc-object doc-module">



<a id="plot_posthoc_test.plot_stat_annotate"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.add_errorbar_loc_on_posthoc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_errorbar_loc_on_posthoc</span><span class="p">(</span><span class="n">posthoc_df</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">,</span> <span class="n">overwrite_num_loc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>merges posthoc df with newly created errorbar span detection</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_errorbar_loc_on_posthoc</span><span class="p">(</span><span class="n">posthoc_df</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">,</span> <span class="n">overwrite_num_loc</span><span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; merges posthoc df with newly created errorbar span detection &#39;&#39;&#39;</span>
    <span class="n">error_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">success_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
        <span class="n">group_info</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">g1_num_loc</span><span class="c1">#=14.125, g2_num_loc=13.5, g1_cat_loc=-0.2, g2_cat_loc=-0.1, max_group_loc_val=14.125</span>
        <span class="c1"># print(row.g1_cat_loc, row.g1_num_loc,row.g2_cat_loc, row.g2_num_loc)</span>
        <span class="n">g1_row_match</span> <span class="o">=</span> <span class="n">get_child_df_row</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">g1_cat_loc</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">g1_num_loc</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;g1_cat_loc&#39;</span><span class="p">:</span><span class="n">row</span><span class="o">.</span><span class="n">g1_cat_loc</span><span class="p">,</span> <span class="s1">&#39;g1_num_loc&#39;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">g1_num_loc</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;g_1&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;child_x&#39;</span><span class="p">,</span><span class="s1">&#39;child_y&#39;</span><span class="p">]},</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">g2_row_match</span> <span class="o">=</span> <span class="n">get_child_df_row</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">g2_cat_loc</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">g2_num_loc</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;g2_cat_loc&#39;</span><span class="p">:</span><span class="n">row</span><span class="o">.</span><span class="n">g2_cat_loc</span><span class="p">,</span> <span class="s1">&#39;g2_num_loc&#39;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">g2_num_loc</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;g_2&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;child_x&#39;</span><span class="p">,</span><span class="s1">&#39;child_y&#39;</span><span class="p">]},</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">success_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">g1_row_match</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">g2_row_match</span><span class="p">[</span><span class="n">g2_row_match</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">g1_row_match</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">g1_row_match</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span><span class="p">(</span><span class="n">g2_row_match</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">error_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">)</span>
    <span class="n">ebar_loc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">success_rows</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">error_rows</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot; len </span><span class="si">{</span><span class="n">error_rows</span><span class="si">}</span><span class="s2"> of error rows list&quot;</span>
    <span class="n">posthoc_df</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ebar_loc</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g1_num_loc&#39;</span><span class="p">,</span> <span class="s1">&#39;g2_num_loc&#39;</span><span class="p">,</span> <span class="s1">&#39;g1_cat_loc&#39;</span><span class="p">,</span> <span class="s1">&#39;g2_cat_loc&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">overwrite_num_loc</span><span class="p">:</span>
        <span class="n">posthoc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;g1_num_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;g_1_child_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">posthoc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;g2_num_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;g_2_child_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">posthoc_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_ax_children_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ax_children_types</span><span class="p">(</span><span class="n">ax_obj</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>To- return list stating what type each child of the mplt ax object is</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ax_children_types</span><span class="p">(</span><span class="n">ax_obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; To- return list stating what type each child of the mplt ax object is&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ax_obj</span><span class="o">.</span><span class="n">get_children</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_child_df_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_child_df_row</span><span class="p">(</span><span class="n">hue_cat_loc</span><span class="p">,</span> <span class="n">hue_num_loc</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>non vectorized function relying on vectorized subfuunctions</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_child_df_row</span><span class="p">(</span><span class="n">hue_cat_loc</span><span class="p">,</span><span class="n">hue_num_loc</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; non vectorized function relying on vectorized subfuunctions&#39;&#39;&#39;</span>
    <span class="c1">##run comparisons to get bool</span>
    <span class="n">is_size_match</span> <span class="o">=</span> <span class="n">bar_coords</span><span class="o">.</span><span class="n">y_is_2_elem</span><span class="c1"># print(is_size_match)</span>
    <span class="n">is_in_child_x_vals</span> <span class="o">=</span> <span class="n">bar_coords</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">hue_cat_loc</span><span class="p">,</span><span class="n">decimals</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">child_x</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">is_hue_point_in_range_bounds</span> <span class="o">=</span> <span class="n">bar_coords</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">is_val_between_range_min_max</span><span class="p">(</span><span class="n">hue_num_loc</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">child_y</span><span class="p">),</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1">#these need to iterate over entire DF to get complete bool made</span>
    <span class="n">bar_row_bool</span> <span class="o">=</span> <span class="n">is_hue_point_in_range_bounds</span> <span class="o">&amp;</span> <span class="n">bar_coords</span><span class="o">.</span><span class="n">y_is_2_elem</span> <span class="o">&amp;</span> <span class="n">is_in_child_x_vals</span>
    <span class="n">row_match</span> <span class="o">=</span> <span class="n">bar_coords</span><span class="p">[</span><span class="n">bar_row_bool</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="s1">&#39;next_collection_index&#39;</span><span class="p">,</span> <span class="s1">&#39;child_index&#39;</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">row_match</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_hue_errorbar_loc_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hue_errorbar_loc_dict</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a dictionary of the data errorbars at each level of the hue variable.</p>
<p>Parameters:
ax_input (matplotlib.axes.Axes): The input axis object.
hue_order (list): The order of the hue in a list.</p>
<p>Returns:
dict: Dictionary with hue errorbar  locations.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_hue_errorbar_loc_dict</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get a dictionary of the data errorbars at each level of the hue variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ax_input (matplotlib.axes.Axes): The input axis object.</span>
<span class="sd">    hue_order (list): The order of the hue in a list.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: Dictionary with hue errorbar  locations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hue_point_loc_dict</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="n">hue_order</span><span class="p">[</span><span class="n">count</span><span class="p">],</span>
                            <span class="s1">&#39;data_locs&#39;</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">get_offsets</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">}</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_input</span><span class="o">.</span><span class="n">collections</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">hue_point_loc_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_hue_loc_on_axis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hue_loc_on_axis</span><span class="p">(</span><span class="n">hue_loc_df</span><span class="p">,</span> <span class="n">posthoc_df</span><span class="p">,</span> <span class="n">detect_error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add numerical and categorical axis locations to the posthoc comparison dataframe. Main function creating/label numeric loc on axis 
NEW (2.6.25)- add detect errorbar  to automatically detect errorbar, and move point marked for symbol loc if so 
Parameters:
hue_loc_df (pandas.DataFrame): DataFrame with hue locations.
posthoc_df (pandas.DataFrame): DataFrame with posthoc comparisons.</p>
<p>Returns:
pandas.DataFrame: Updated DataFrame with axis locations.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_hue_loc_on_axis</span><span class="p">(</span><span class="n">hue_loc_df</span><span class="p">,</span> <span class="n">posthoc_df</span><span class="p">,</span> <span class="n">detect_error_bar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Add numerical and categorical axis locations to the posthoc comparison dataframe. Main function creating/label numeric loc on axis </span>
<span class="sd">    NEW (2.6.25)- add detect errorbar  to automatically detect errorbar, and move point marked for symbol loc if so </span>
<span class="sd">    Parameters:</span>
<span class="sd">    hue_loc_df (pandas.DataFrame): DataFrame with hue locations.</span>
<span class="sd">    posthoc_df (pandas.DataFrame): DataFrame with posthoc comparisons.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: Updated DataFrame with axis locations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; given hue_loc_df listing where each point for the given hue categories are located, use the pre-existing post hoc comparison df</span>
<span class="sd">    and add a new column to dataframe indicating y/numerical ax loc for each comparison </span>
<span class="sd">    g1/2_num_loc: the value of position of group 1/2 (usually on the y axis) on the numerical axis used</span>
<span class="sd">    g1/2_cat_loc: the value of point of group 1/2 (usually on the x axis) on the categorical axis used</span>
<span class="sd">    group_1/2_order_pos is used to to know what the values are &quot;&quot;&quot;</span>
        <span class="c1">## get loc of points on the numerical ax (usually y but not always)</span>
        <span class="c1">#index into hueloc df, with index = hue Group_1 name of posthoc df ; then, get list of point vals in collection; then, </span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;hue_group_1_locs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">hue_loc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;group_1&#39;</span><span class="p">]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#elem index = what x tick num elem is centered on</span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;hue_group_2_locs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">hue_loc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;group_2&#39;</span><span class="p">]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#elem index = what x tick num elem is centered on</span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;g1_num_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;hue_group_1_locs&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;group_1_order_pos&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#x[&#39;group_1_order_pos&#39;][0] = position of group 1 being used, in ordered list of collections </span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;g2_num_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;hue_group_2_locs&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;group_2_order_pos&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#x[&#39;group_1_order_pos&#39;][0] = position of group 1 being used, in ordered list of collections </span>

    <span class="c1">## get location of poitns on the categorical axis (usually x but not always)</span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;g1_cat_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;hue_group_1_locs&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;group_1_order_pos&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#x[&#39;group_1_order_pos&#39;][0] = position of group 1 being used, in ordered list of collections </span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;g2_cat_loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;hue_group_2_locs&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;group_2_order_pos&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#x[&#39;group_1_order_pos&#39;][0] = position of group 1 being used, in ordered list of collections</span>
    <span class="c1">#get max of numerical ax values</span>
    <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;max_group_loc_val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">posthoc_df</span><span class="p">[[</span><span class="s1">&#39;g1_num_loc&#39;</span><span class="p">,</span> <span class="s1">&#39;g2_num_loc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">posthoc_df</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_hue_point_loc_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hue_point_loc_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a DataFrame of the datapoints at each level of the hue variable.</p>
<p>Parameters:
ax_input (matplotlib.axes.Axes): The input axis object.
hue_order (list): The order of the hue.</p>
<p>Returns:
pandas.DataFrame: DataFrame with hue point locations.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_hue_point_loc_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get a DataFrame of the datapoints at each level of the hue variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ax_input (matplotlib.axes.Axes): The input axis object.</span>
<span class="sd">    hue_order (list): The order of the hue.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with hue point locations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hue_loc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">get_hue_point_loc_dict</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">))</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;hue&#39;</span><span class="p">)</span> <span class="c1">#get array of numerical points and values for each hue level</span>
    <span class="k">return</span> <span class="n">hue_loc_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_hue_point_loc_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hue_point_loc_dict</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a dictionary of the datapoints at each level of the hue variable.</p>
<p>Parameters:
ax_input (matplotlib.axes.Axes): The input axis object.
hue_order (list): The order of the hue.</p>
<p>Returns:
dict: Dictionary with hue point locations.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_hue_point_loc_dict</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get a dictionary of the datapoints at each level of the hue variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ax_input (matplotlib.axes.Axes): The input axis object.</span>
<span class="sd">    hue_order (list): The order of the hue.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: Dictionary with hue point locations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hue_point_loc_dict</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="n">hue_order</span><span class="p">[</span><span class="n">count</span><span class="p">],</span> <span class="s1">&#39;data_locs&#39;</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">get_offsets</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">}</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_input</span><span class="o">.</span><span class="n">collections</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">hue_point_loc_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_pair_stat_test_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pair_stat_test_result</span><span class="p">(</span><span class="n">test_name</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">group_1_name</span><span class="p">,</span> <span class="n">group_2_name</span><span class="p">,</span> <span class="n">data_group_1_values</span><span class="p">,</span> <span class="n">data_group_2_values</span><span class="p">,</span> <span class="n">ax_var_is_hue</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Run statistical test on data groups.</p>
<p>Parameters:
test_name (str): The name of the test.
ax_category_level (str): The axis category level.
group_order (iterable): The order of the groups.
group_1_name (str): The name of the first group.
group_2_name (str): The name of the second group.
data_group_1_values (numpy.ndarray): Values of the first group.
data_group_2_values (numpy.ndarray): Values of the second group.
ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</p>
<p>Returns:
dict: Dictionary with the statistical test results.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_pair_stat_test_result</span><span class="p">(</span><span class="n">test_name</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">,</span><span class="n">group_order</span><span class="p">,</span> <span class="n">group_1_name</span><span class="p">,</span> <span class="n">group_2_name</span><span class="p">,</span> <span class="n">data_group_1_values</span><span class="p">,</span><span class="n">data_group_2_values</span><span class="p">,</span><span class="n">ax_var_is_hue</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Run statistical test on data groups.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    test_name (str): The name of the test.</span>
<span class="sd">    ax_category_level (str): The axis category level.</span>
<span class="sd">    group_order (iterable): The order of the groups.</span>
<span class="sd">    group_1_name (str): The name of the first group.</span>
<span class="sd">    group_2_name (str): The name of the second group.</span>
<span class="sd">    data_group_1_values (numpy.ndarray): Values of the first group.</span>
<span class="sd">    data_group_2_values (numpy.ndarray): Values of the second group.</span>
<span class="sd">    ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: Dictionary with the statistical test results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Run stats test on data_group_1_values and data_group_2_values (user input for test )</span>
<span class="sd">    ax order- tells you what order elements in the hue category levels are spread across the ax, so you can use later for indexing&#39;&#39;&#39;</span>
    <span class="c1">## run stats on group values</span>
    <span class="n">stat_result</span><span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">test_name</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;custom test ran&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">test_name</span> <span class="o">==</span> <span class="s1">&#39;MWU&#39;</span><span class="p">:</span>
            <span class="n">stat_result</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">data_group_1_values</span><span class="p">,</span> <span class="n">data_group_2_values</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">test_name</span> <span class="o">==</span> <span class="s1">&#39;bootstrap_sdev_overlap&#39;</span><span class="p">:</span>
            <span class="n">stat_result</span> <span class="o">=</span> <span class="n">test_group_mean_separation</span><span class="p">(</span><span class="n">data_group_1_values</span><span class="p">,</span> <span class="n">data_group_2_values</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">test_name</span> <span class="o">==</span> <span class="s1">&#39;2_sample_t_test&#39;</span><span class="p">:</span>
            <span class="n">stat_result</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data_group_1_values</span><span class="p">,</span> <span class="n">data_group_2_values</span><span class="p">,</span> <span class="n">equal_var</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1">#equal_var = True, run 2 sample ttset, if false, run welch&#39;s test for unequal var</span>
    <span class="k">elif</span> <span class="n">test_name</span> <span class="o">==</span> <span class="s1">&#39;permutation_test&#39;</span><span class="p">:</span>
            <span class="n">stat_result</span> <span class="o">=</span>  <span class="n">run_permutation_test_on_diff_of_vector_means</span><span class="p">(</span> <span class="n">data_group_1_values</span><span class="p">,</span> <span class="n">data_group_2_values</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span> <span class="c1">#set to .values as original output is dict, and rounding a rdict fails </span>
    <span class="c1">#record the stat values (mean, sem etc)     </span>
    <span class="k">if</span> <span class="n">test_name</span> <span class="o">==</span> <span class="s1">&#39;bootstrap_sdev_overlap&#39;</span><span class="p">:</span>

        <span class="n">group_mean_dict</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;group_1_mean&#39;</span><span class="p">:</span><span class="n">stat_result</span><span class="p">[</span><span class="s1">&#39;group_1_mean&#39;</span><span class="p">],</span> <span class="s1">&#39;group_1_sem&#39;</span><span class="p">:</span><span class="n">stat_result</span><span class="p">[</span><span class="s1">&#39;group_1_std&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;group_2_mean&#39;</span><span class="p">:</span><span class="n">stat_result</span><span class="p">[</span><span class="s1">&#39;group_2_mean&#39;</span><span class="p">],</span> <span class="s1">&#39;group_2_sem&#39;</span><span class="p">:</span><span class="n">stat_result</span><span class="p">[</span><span class="s1">&#39;group_2_std&#39;</span><span class="p">]}</span>
        <span class="n">stat_result</span> <span class="o">=</span> <span class="p">[</span><span class="n">stat_result</span><span class="p">[</span><span class="s1">&#39;mean_diff_more_than_sdevs&#39;</span><span class="p">],</span> <span class="n">stat_result</span><span class="p">[</span><span class="s1">&#39;pseudo_pvalue&#39;</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">group_mean_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;group_1_mean&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">data_group_1_values</span><span class="p">),</span> <span class="s1">&#39;group_1_sem&#39;</span><span class="p">:</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">data_group_1_values</span><span class="p">,</span><span class="n">nan_policy</span> <span class="o">=</span> <span class="s1">&#39;omit&#39;</span> <span class="p">),</span>
                            <span class="s1">&#39;group_2_mean&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">data_group_2_values</span><span class="p">),</span> <span class="s1">&#39;group_2_sem&#39;</span><span class="p">:</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">data_group_2_values</span><span class="p">,</span><span class="n">nan_policy</span> <span class="o">=</span> <span class="s1">&#39;omit&#39;</span><span class="p">)}</span>
    <span class="c1">#pack and return result dict</span>
    <span class="c1"># print(group_order)</span>
    <span class="k">if</span> <span class="n">ax_var_is_hue</span><span class="p">:</span> <span class="c1">#if x categorical ticks = hue groups, find index of group1 name in hue order</span>
        <span class="n">group_pos</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;group_1_order_pos&#39;</span><span class="p">:</span> <span class="n">get_match_index_in_iterable</span><span class="p">(</span><span class="n">group_order</span><span class="p">,</span> <span class="n">group_1_name</span><span class="p">),</span>
                   <span class="s1">&#39;group_2_order_pos&#39;</span><span class="p">:</span> <span class="n">get_match_index_in_iterable</span><span class="p">(</span><span class="n">group_order</span><span class="p">,</span> <span class="n">group_2_name</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#else, find index of ax_category_tick name in xtick order, to pull correct point loc (say of wt-veh, at late IA tick)</span>
        <span class="n">group_pos</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;group_1_order_pos&#39;</span><span class="p">:</span> <span class="n">get_match_index_in_iterable</span><span class="p">(</span><span class="n">group_order</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">),</span>
                   <span class="s1">&#39;group_2_order_pos&#39;</span><span class="p">:</span> <span class="n">get_match_index_in_iterable</span><span class="p">(</span><span class="n">group_order</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">)}</span>
        <span class="c1">#get where the groups being compared, are listed in the data collections f</span>
    <span class="n">result_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category_compared_within&#39;</span><span class="p">:</span> <span class="n">ax_category_level</span><span class="p">,</span> <span class="s1">&#39;group_1&#39;</span><span class="p">:</span> <span class="n">group_1_name</span><span class="p">,</span> <span class="s1">&#39;group_2&#39;</span><span class="p">:</span><span class="n">group_2_name</span><span class="p">,</span>
                   <span class="s1">&#39;group_1_n&#39;</span><span class="p">:</span><span class="n">data_group_1_values</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;group_2_n&#39;</span><span class="p">:</span><span class="n">data_group_2_values</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">group_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">group_mean_dict</span><span class="p">,</span>
                    <span class="s1">&#39;test_name&#39;</span><span class="p">:</span> <span class="n">test_name</span><span class="p">,</span> <span class="s1">&#39;stat_result&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">stat_result</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">:</span> <span class="n">stat_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
    <span class="k">return</span> <span class="n">result_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_sig_bar_x_vals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sig_bar_x_vals</span><span class="p">(</span><span class="n">comparison_tuple</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the x-values for the significance bar.</p>
<p>Parameters:
comparison_tuple (namedtuple): Tuple with comparison information.</p>
<p>Returns:
list: List of x-values for the significance bar.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_sig_bar_x_vals</span><span class="p">(</span><span class="n">comparison_tuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get the x-values for the significance bar.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    comparison_tuple (namedtuple): Tuple with comparison information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    list: List of x-values for the significance bar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">comparison_tuple</span><span class="o">.</span><span class="n">g1_cat_loc</span><span class="p">,</span> <span class="n">comparison_tuple</span><span class="o">.</span><span class="n">g1_cat_loc</span><span class="p">,</span>
              <span class="n">comparison_tuple</span><span class="o">.</span><span class="n">g2_cat_loc</span><span class="p">,</span> <span class="n">comparison_tuple</span><span class="o">.</span><span class="n">g2_cat_loc</span><span class="p">]</span><span class="c1"># list the 4 x coord for points that define the line</span>
    <span class="k">return</span> <span class="n">x_vals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_sig_bar_y_vals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sig_bar_y_vals</span><span class="p">(</span><span class="n">bottom_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line_height</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the y-values for the significance bar.
Parameters:
bottom_val (float, optional): The bottom value for the bar. Defaults to 0.95.
line_height (float, optional): The height of the line. Defaults to 1.01.</p>
<p>Returns:
list: List of y-values for the significance bar.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_sig_bar_y_vals</span><span class="p">(</span><span class="n">bottom_val</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">line_height</span><span class="o">=</span> <span class="mf">1.01</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get the y-values for the significance bar.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    bottom_val (float, optional): The bottom value for the bar. Defaults to 0.95.</span>
<span class="sd">    line_height (float, optional): The height of the line. Defaults to 1.01.</span>

<span class="sd">    Returns:</span>
<span class="sd">    list: List of y-values for the significance bar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; comparison tuple max y value is multipled by offset factor&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bottom_val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bottom_val</span> <span class="o">=</span> <span class="mf">0.95</span> <span class="c1">#for ax relative point plotting</span>
    <span class="c1"># bottom_val = comparison_tuple.max_group_loc_val * offset_factor #for data point plotting</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">bottom_val</span><span class="p">,</span><span class="n">bottom_val</span><span class="o">*</span> <span class="n">line_height</span><span class="p">,</span> <span class="n">bottom_val</span><span class="o">*</span><span class="n">line_height</span><span class="p">,</span><span class="n">bottom_val</span><span class="p">]</span><span class="c1"># list the 4 x coord for points that define the line</span>
    <span class="k">return</span> <span class="n">y_vals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.get_x_ticks_as_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_x_ticks_as_df</span><span class="p">(</span><span class="n">ticklabel_obj</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a DataFrame of the x-tick labels and their positions.</p>
<p>Parameters:
ticklabel_obj (list): List of tick label objects.</p>
<p>Returns:
pandas.DataFrame: DataFrame with x-tick labels and positions.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_x_ticks_as_df</span><span class="p">(</span><span class="n">ticklabel_obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Get a DataFrame of the x-tick labels and their positions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ticklabel_obj (list): List of tick label objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with x-tick labels and positions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ticks_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">([{</span><span class="s1">&#39;tick_text&#39;</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">get_text</span><span class="p">(),</span> <span class="s1">&#39;tick_pos&#39;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">get_position</span><span class="p">()}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticklabel_obj</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ticks_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.is_val_between_range_min_max" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_val_between_range_min_max</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">range_array</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>smple function</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_val_between_range_min_max</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">range_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; smple function&#39;&#39;&#39;</span>
    <span class="n">is_lessthan_max</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">range_array</span><span class="p">)</span>
    <span class="n">is_greaterthan_min</span> <span class="o">=</span> <span class="n">value</span><span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">range_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">is_lessthan_max</span> <span class="o">&amp;</span> <span class="n">is_greaterthan_min</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.main_run_posthoc_tests_and_get_hue_loc_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main_run_posthoc_tests_and_get_hue_loc_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">plot_params</span><span class="p">,</span> <span class="n">plot_obj</span><span class="p">,</span> <span class="n">preset_comparisons</span><span class="p">,</span> <span class="n">hue_var</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax_var_is_hue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">detect_error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Run posthoc tests on all axis ticks, get hue levels for each axis tick, and join this to the dataframe produced.</p>
<p>Parameters:
ax_input (matplotlib.axes.Axes): The input axis object.
plot_params (dict): Dictionary containing plot parameters.
plot_obj (seaborn.axisgrid.FacetGrid): The plot object.
preset_comparisons (list): List of preset comparisons.
hue_var (str, optional): The hue variable. Defaults to None.
test_name (str, optional): The name of the test. Defaults to None.
hue_order (list, optional): The order of the hue. Defaults to None.
ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</p>
<p>Returns:
pandas.DataFrame: DataFrame with posthoc test results and hue locations.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main_run_posthoc_tests_and_get_hue_loc_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">plot_params</span><span class="p">,</span> <span class="n">plot_obj</span><span class="p">,</span> <span class="n">preset_comparisons</span><span class="p">,</span>
                                               <span class="n">hue_var</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">test_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hue_order</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax_var_is_hue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">detect_error_bar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Run posthoc tests on all axis ticks, get hue levels for each axis tick, and join this to the dataframe produced.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ax_input (matplotlib.axes.Axes): The input axis object.</span>
<span class="sd">    plot_params (dict): Dictionary containing plot parameters.</span>
<span class="sd">    plot_obj (seaborn.axisgrid.FacetGrid): The plot object.</span>
<span class="sd">    preset_comparisons (list): List of preset comparisons.</span>
<span class="sd">    hue_var (str, optional): The hue variable. Defaults to None.</span>
<span class="sd">    test_name (str, optional): The name of the test. Defaults to None.</span>
<span class="sd">    hue_order (list, optional): The order of the hue. Defaults to None.</span>
<span class="sd">    ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with posthoc test results and hue locations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">hue_var</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hue_var</span> <span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;hue&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">hue_order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hue_order</span> <span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;hue_order&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">test_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># group_order- depends on if comparing within x axis, or within hues </span>
    <span class="k">if</span> <span class="n">ax_var_is_hue</span><span class="p">:</span> <span class="c1">#you will use this to find the ordering of the hue collection points of interest</span>
        <span class="n">group_order</span> <span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;hue_order&#39;</span><span class="p">]</span> <span class="c1">#order in collection = order in hue</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#if hue collection tiled over differnt x categories</span>
        <span class="n">group_order</span> <span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="c1">#order in collection = order in x category</span>
    <span class="n">posthoc_df</span> <span class="o">=</span> <span class="n">run_posthoc_tests_on_all_ax_ticks</span><span class="p">(</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">plot_obj</span><span class="p">,</span> 
                                                   <span class="n">comparison_list</span> <span class="o">=</span><span class="n">preset_comparisons</span><span class="p">,</span> <span class="n">ax_grouping_col</span><span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                                                   <span class="n">group_order</span> <span class="o">=</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">hue_col_name</span><span class="o">=</span><span class="n">hue_var</span><span class="p">,</span> <span class="n">value_col_name</span> <span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                                                   <span class="n">test_name</span> <span class="o">=</span> <span class="n">test_name</span><span class="p">,</span><span class="n">ax_var_is_hue</span><span class="o">=</span><span class="n">ax_var_is_hue</span><span class="p">)</span><span class="c1">## get df with info on post-hoc comparisons</span>
    <span class="n">hue_loc_df</span> <span class="o">=</span> <span class="n">get_hue_point_loc_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">hue_order</span><span class="p">)</span> <span class="c1"># hue_loc_df = pd.DataFrame.from_dict(get_hue_point_loc_dict(plot_ax, geno_order)).set_index(&#39;hue&#39;) #get array of numerical points and values for each hue level</span>
    <span class="n">posthoc_df</span> <span class="o">=</span> <span class="n">get_hue_loc_on_axis</span><span class="p">(</span><span class="n">hue_loc_df</span><span class="p">,</span> <span class="n">posthoc_df</span><span class="p">)</span> <span class="c1">#find pos in numerical ax of fig, then add as cols to df</span>
    <span class="c1">#manually set cat compared within to single variable if hue == axis category</span>
    <span class="k">if</span> <span class="n">ax_var_is_hue</span><span class="p">:</span> <span class="c1">#you will use this to find the ordering of the hue collection points of interest</span>
        <span class="n">posthoc_df</span><span class="p">[</span><span class="s1">&#39;category_compared_within&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">detect_error_bar</span><span class="p">:</span> <span class="c1">#NEW_ add errorbar locs to posthoc df</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error bar detected, moving bounds&#39;</span><span class="p">)</span>
        <span class="n">ax_childs</span> <span class="o">=</span><span class="n">plot_obj</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
        <span class="n">ax_child_points_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">count</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">get_ax_children_types</span><span class="p">(</span><span class="n">plot_obj</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">path_collection_type</span><span class="p">]</span>
        <span class="n">bar_coords</span> <span class="o">=</span>  <span class="n">return_ax_child_line_coor</span><span class="p">(</span><span class="n">ax_childs</span><span class="p">,</span><span class="n">ax_child_points_index</span><span class="p">)</span>
        <span class="n">posthoc_df</span> <span class="o">=</span><span class="n">add_errorbar_loc_on_posthoc</span><span class="p">(</span><span class="n">posthoc_df</span><span class="p">,</span> <span class="n">bar_coords</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">posthoc_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.plot_sig_bars_w_comp_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_sig_bars_w_comp_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">sig_comp_df</span><span class="p">,</span> <span class="n">direction_to_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot significance bars with comparison dataframe.</p>
<p>Parameters:
   ax_input (matplotlib.axes.Axes): The input axis object.
   sig_comp_df (pandas.DataFrame): DataFrame with significance comparisons.
   direction_to_plot (str, optional): Direction to plot ('top_down', 'bottom_up'). Defaults to 'bottom_up'.
TO- given parameters, plot vertical lines between centers of datapoints of interest (pre-sorted), with significance star (pre-calculated)</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_sig_bars_w_comp_df</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">sig_comp_df</span><span class="p">,</span> <span class="n">direction_to_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Plot significance bars with comparison dataframe.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ax_input (matplotlib.axes.Axes): The input axis object.</span>
<span class="sd">    sig_comp_df (pandas.DataFrame): DataFrame with significance comparisons.</span>
<span class="sd">    direction_to_plot (str, optional): Direction to plot (&#39;top_down&#39;, &#39;bottom_up&#39;). Defaults to &#39;bottom_up&#39;.</span>
<span class="sd"> TO- given parameters, plot vertical lines between centers of datapoints of interest (pre-sorted), with significance star (pre-calculated)&quot;&quot;&quot;</span>
    <span class="c1">## plotting params</span>
    <span class="k">if</span> <span class="n">direction_to_plot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span><span class="c1">#set direction to plot (&#39;top_down&#39;, &#39;bottom_up&#39;)</span>
        <span class="n">direction_to_plot</span> <span class="o">=</span> <span class="s1">&#39;bottom_up&#39;</span>

    <span class="n">line_height</span> <span class="o">=</span> <span class="mf">1.01</span>
    <span class="n">offset_constant</span> <span class="o">=</span> <span class="mf">0.025</span> <span class="c1">#what linear amount to add</span>
    <span class="n">star_space_to_line</span> <span class="o">=</span> <span class="n">offset_constant</span><span class="o">/</span><span class="mi">5</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">x_transform</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span><span class="n">y_transform</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span><span class="c1"># the x coords of this transformation are data, and the y coord are axes</span>
    <span class="c1">## main loop over categorical ticks</span>
    <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">sig_comp_df</span><span class="o">.</span><span class="n">category_compared_within</span><span class="p">:</span><span class="c1">#iterate over each categorical tick value</span>
        <span class="n">top_bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="c1">#initialize box location for comparison # =[lower_x, lower_y] [upper_x, upper_y]</span>
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">sig_comp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sig_comp_df</span><span class="o">.</span><span class="n">category_compared_within</span> <span class="o">==</span> <span class="n">cat</span><span class="p">,:]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="n">get_sig_bar_x_vals</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span> <span class="c1"># [comp.g1_cat_loc, comp.g1_cat_loc, comp.g2_cat_loc, comp.g2_cat_loc]# list the 4 x coord for points that define the line</span>
            <span class="n">y_vals</span> <span class="o">=</span><span class="n">get_sig_bar_y_vals</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="n">line_height</span><span class="p">)</span> <span class="c1">#  [comp.max_group_loc_val, comp.max_group_loc_val * h, comp.max_group_loc_val * h, comp.max_group_loc_val] # list 4 y coord for points that define the line</span>
            <span class="n">line_overlap</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">y_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1">##check overlap with previous bounding box</span>
            <span class="k">if</span> <span class="n">line_overlap</span><span class="p">:</span> <span class="c1">#if the top of the prev bbox overlaps with the current line, move the current line up to ABOVE top bbox</span>
                <span class="n">y_vals</span> <span class="o">=</span> <span class="n">get_sig_bar_y_vals</span><span class="p">(</span><span class="n">top_bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">offset_constant</span><span class="p">,</span><span class="n">line_height</span><span class="p">)</span>             <span class="c1">## if overlaps with previous bounding box, adjust height by N</span>
            <span class="n">text_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="n">x_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="mf">.5</span>
            <span class="n">text_y</span> <span class="o">=</span> <span class="n">y_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">star_space_to_line</span>
            <span class="c1">#plot sig star over line</span>
            <span class="n">ax_input</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">annotator_default</span><span class="p">[</span><span class="s1">&#39;line_width&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">star_annot</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">convert_pvalue_to_asterisks</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">pvalue</span><span class="p">),</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">text_x</span><span class="p">,</span> <span class="n">text_y</span><span class="p">),</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;axes fraction&#39;</span><span class="p">),</span>
                            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span><span class="p">,)</span><span class="c1"># bbox = {&#39;boxstyle&#39;: &#39;Square, pad = 0.0&#39;, &#39;fc&#39;: &#39;lightblue&#39;, &#39;lw&#39;: 0})</span>
            <span class="n">bbox_in_ax</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transAxes</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">star_annot</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">())</span> <span class="c1"># to get ax coordinates of bounding box (transform from  Return the Bbox bounding the text, in display units.)</span>
            <span class="n">top_bbox</span> <span class="o">=</span> <span class="n">bbox_in_ax</span>      <span class="c1">#detect overlap by storing, then comparing ot previous versions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.plot_sig_bars_w_comp_df_tight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_sig_bars_w_comp_df_tight</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">sig_comp_df</span><span class="p">,</span> <span class="n">direction_to_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tight_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset_constant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot significance bars with comparison dataframe, using a tight layout.
TO- given parameters, plot vertical lines between centers of datapoints of interest (pre-sorted), with significance star (pre-calculated)
Parameters
ax_input (matplotlib.axes.Axes): The input axis object.
sig_comp_df (pandas.DataFrame): DataFrame with significance comparisons.
direction_to_plot (str, optional): Direction to plot ('top_down', 'bottom_up'). Defaults to 'bottom_up'.
tight (bool, optional): Whether to plot bars right above their corresponding values. Defaults to True.
tight_offset (float, optional): Offset for tight layout. Defaults to 0.075.
offset_constant (float, optional): Constant for offset. Defaults to 0.0225.
debug (bool, optional): Whether to print debug information. Defaults to None.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_sig_bars_w_comp_df_tight</span><span class="p">(</span><span class="n">ax_input</span><span class="p">,</span> <span class="n">sig_comp_df</span><span class="p">,</span> <span class="n">direction_to_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tight</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tight_offset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">offset_constant</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Plot significance bars with comparison dataframe, using a tight layout.</span>
<span class="sd">    TO- given parameters, plot vertical lines between centers of datapoints of interest (pre-sorted), with significance star (pre-calculated)</span>
<span class="sd">    Parameters</span>
<span class="sd">    ax_input (matplotlib.axes.Axes): The input axis object.</span>
<span class="sd">    sig_comp_df (pandas.DataFrame): DataFrame with significance comparisons.</span>
<span class="sd">    direction_to_plot (str, optional): Direction to plot (&#39;top_down&#39;, &#39;bottom_up&#39;). Defaults to &#39;bottom_up&#39;.</span>
<span class="sd">    tight (bool, optional): Whether to plot bars right above their corresponding values. Defaults to True.</span>
<span class="sd">    tight_offset (float, optional): Offset for tight layout. Defaults to 0.075.</span>
<span class="sd">    offset_constant (float, optional): Constant for offset. Defaults to 0.0225.</span>
<span class="sd">    debug (bool, optional): Whether to print debug information. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## plotting params    #set direction to plot (&#39;top_down&#39;, &#39;bottom_up&#39;) #set whether bars are plotted right above their coresponding values, or not</span>
    <span class="c1">#declare initial transforms of interest</span>
    <span class="n">transform_ax_to_data</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transAxes</span> <span class="o">+</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span> <span class="c1">#create ax-display + display-data pipe</span>
    <span class="n">transform_data_to_ax</span> <span class="o">=</span> <span class="n">transform_ax_to_data</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span> <span class="c1"># </span>
    <span class="c1">#default vcalues</span>
    <span class="k">if</span> <span class="n">direction_to_plot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">direction_to_plot</span> <span class="o">=</span> <span class="s1">&#39;bottom_up&#39;</span>
        <span class="n">line_start_y_pos</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="c1">#base case- plot upwards from 0.8 of ax size </span>
    <span class="k">if</span> <span class="n">tight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tight</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">#set whether or not to plot bars RIGHT above datapoints</span>
    <span class="k">if</span> <span class="n">tight_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tight_offset</span> <span class="o">=</span> <span class="mf">0.075</span> <span class="c1">#fraction of ax to put between the point of interest and the line of sig post-hoc</span>
    <span class="c1">#params for offsetting</span>
    <span class="n">line_height</span> <span class="o">=</span> <span class="mf">1.00</span> <span class="c1">#base case- 1.01</span>
    <span class="k">if</span> <span class="n">offset_constant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">offset_constant</span> <span class="o">=</span> <span class="mf">0.0225</span> <span class="c1">#what linear amount to add, in AX FRACTION AMOUNT </span>

    <span class="n">star_space_to_line</span> <span class="o">=</span> <span class="n">offset_constant</span><span class="o">*</span><span class="mf">0.1</span>
    <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tight format, max_numeric_ax_value = </span><span class="si">{</span><span class="n">max_numeric_ax_value</span><span class="si">}</span><span class="s1">.  start y val  = </span><span class="si">{</span><span class="n">line_start_y_pos</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#transData transforms: (DATA) -&gt; (DISPLAY COORDINATES)     # transAxes transforms (AXES) -&gt; (DISPLAY)     #all transforms -&gt; display coords </span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">x_transform</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span>
                                                            <span class="n">y_transform</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span><span class="c1"># the x coords of this transformation are data, and the y coord are axes</span>
    <span class="c1">## main loop over categorical ticks, bottom up approach </span>
    <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">sig_comp_df</span><span class="o">.</span><span class="n">category_compared_within</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span><span class="c1">#iterate over each categorical tick value</span>
        <span class="n">top_bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="c1">#initialize box location for comparison # =[lower_x, lower_y] [upper_x, upper_y]</span>
        <span class="c1">#get max y position value for each category you&#39;re doing post-hoc comparisons within</span>
        <span class="n">sig_comp_category</span> <span class="o">=</span> <span class="n">sig_comp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sig_comp_df</span><span class="o">.</span><span class="n">category_compared_within</span> <span class="o">==</span> <span class="n">cat</span><span class="p">,:]</span>
        <span class="k">if</span> <span class="n">tight</span><span class="p">:</span>
            <span class="n">max_numeric_ax_value</span> <span class="o">=</span> <span class="n">sig_comp_category</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;g1_num_loc&#39;</span><span class="p">,</span><span class="s1">&#39;g2_num_loc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>    <span class="c1">#get max val in the group of interest you&#39;re running posthocs on (x ticks of interest)    </span>
            <span class="n">line_start_y_pos</span> <span class="o">=</span> <span class="n">transform_data_to_ax</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">max_numeric_ax_value</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">tight_offset</span> <span class="c1"># data -&gt; axes </span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tight format, max_numeric_ax_value = </span><span class="si">{</span><span class="n">max_numeric_ax_value</span><span class="si">}</span><span class="s1">.  start y val  = </span><span class="si">{</span><span class="n">line_start_y_pos</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1">#transData transforms: (DATA) -&gt; (DISPLAY COORDINATES)     # transAxes transforms (AXES) -&gt; (DISPLAY)     </span>
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">sig_comp_category</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">x_vals</span> <span class="o">=</span> <span class="n">get_sig_bar_x_vals</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span> <span class="c1"># [comp.g1_cat_loc, comp.g1_cat_loc, comp.g2_cat_loc, comp.g2_cat_loc]# list the 4 x coord for points that define the line</span>
            <span class="n">y_vals</span> <span class="o">=</span><span class="n">get_sig_bar_y_vals</span><span class="p">(</span><span class="n">line_start_y_pos</span><span class="p">,</span><span class="n">line_height</span><span class="p">)</span> <span class="c1">#  [comp.max_group_loc_val, comp.max_group_loc_val * h, comp.max_group_loc_val * h, comp.max_group_loc_val] # list 4 y coord for points that define the line</span>
            <span class="c1">#compare overlap of proposed y values, in data space </span>
            <span class="n">line_overlap</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">y_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1">##check y overlap with previous bounding box,       #top right point y val in top_box defined by [1,1]</span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;line overlap = (</span><span class="si">{</span><span class="n">top_bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> &gt;= </span><span class="si">{</span><span class="n">y_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;line x_vals, y_vals: </span><span class="si">{</span><span class="n">x_vals</span><span class="p">,</span><span class="w"> </span><span class="n">y_vals</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line_overlap</span><span class="p">:</span> <span class="c1">#if the top of the prev bbox overlaps with the current line, move the current line up to ABOVE top bbox</span>
                <span class="n">y_vals</span> <span class="o">=</span> <span class="n">get_sig_bar_y_vals</span><span class="p">(</span><span class="n">top_bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">offset_constant</span><span class="p">,</span><span class="n">line_height</span><span class="p">)</span>             <span class="c1">## if overlaps with previous bounding box, adjust height by N</span>

            <span class="n">text_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="n">x_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="mf">.5</span>
            <span class="n">text_y</span> <span class="o">=</span> <span class="n">y_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">star_space_to_line</span><span class="c1">#what linear amount to separate star from line, in AX FRACTION AMOUNT </span>
            <span class="c1">#plot sig star over line</span>
            <span class="n">ax_input</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">annotator_default</span><span class="p">[</span><span class="s1">&#39;line_width&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">star_annot</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">convert_pvalue_to_asterisks</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">pvalue</span><span class="p">),</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">text_x</span><span class="p">,</span> <span class="n">text_y</span><span class="p">),</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;axes fraction&#39;</span><span class="p">),</span>
                            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;x-small&#39;</span><span class="p">,</span><span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;light&#39;</span><span class="p">)</span><span class="c1"># bbox = {&#39;boxstyle&#39;: &#39;Square, pad = 0.0&#39;, &#39;fc&#39;: &#39;lightblue&#39;, &#39;lw&#39;: 0})</span>
            <span class="n">bbox_in_ax</span> <span class="o">=</span> <span class="n">ax_input</span><span class="o">.</span><span class="n">transAxes</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">star_annot</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">())</span> <span class="c1">#Get the artist&#39;s bounding box in display space.</span>
            <span class="c1"># ax.transData.inverted() is a matplotlib.transforms.Transform that goes from display coordinates to data coordinates</span>
            <span class="n">top_bbox</span> <span class="o">=</span> <span class="n">bbox_in_ax</span>      <span class="c1">#detect overlap by storing, then comparing ot previous versions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.return_ax_child_line_coor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">return_ax_child_line_coor</span><span class="p">(</span><span class="n">ax_childs</span><span class="p">,</span> <span class="n">ax_child_points_index</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Given a set of indices of the ax child objects between which to query (e.g. path collections index), find fully nonnan yvals in the lines (corresponding to the actual real vertical errorbar) and return coords</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">return_ax_child_line_coor</span><span class="p">(</span><span class="n">ax_childs</span><span class="p">,</span> <span class="n">ax_child_points_index</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Given a set of indices of the ax child objects between which to query (e.g. path collections index), find fully nonnan yvals in the lines (corresponding to the actual real vertical errorbar) and return coords&#39;&#39;&#39;</span>
    <span class="c1">#get errorbar lims via #get non nan values</span>
    <span class="n">ci_info</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_child_points_index</span><span class="p">):</span>
        <span class="c1">#get range around points, looking back  </span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">range_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">range_start</span> <span class="o">=</span> <span class="n">ax_child_points_index</span><span class="p">[</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">range_end</span> <span class="o">=</span> <span class="n">i</span>
        <span class="c1"># main body</span>
        <span class="n">child_range</span> <span class="o">=</span> <span class="n">ax_childs</span><span class="p">[</span><span class="n">range_start</span><span class="p">:</span> <span class="n">range_end</span><span class="p">]</span> <span class="c1">#create list of ax children instances</span>
        <span class="c1">#store each entry in a list of 1 dict per line obj </span>
        <span class="n">cis</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;child_index&#39;</span><span class="p">:</span> <span class="n">count</span> <span class="o">+</span> <span class="n">range_start</span> <span class="p">,</span>
                <span class="s1">&#39;child_x&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(),</span><span class="n">decimals</span> <span class="o">=</span> <span class="mi">2</span><span class="p">),</span>
                <span class="s1">&#39;child_y&#39;</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">(),</span>
               <span class="s1">&#39;next_collection_index&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">child_range</span><span class="p">)]</span> <span class="c1">#each child N gets a dict N with information</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">cis</span><span class="p">)</span>
        <span class="n">ci_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
    <span class="c1"># ci_x = [x.get_xdata() for x in child_range] # ci_y = [x.get_ydata() for x in child_range] #old way of getting x values</span>
    <span class="c1">#NEW LOGIC- drop nan rows (as those arne&#39;t real lines)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ci_info</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y_is_nonnan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">child_y</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
    <span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y_is_2_elem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">child_y</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">drop_nan_row</span><span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">drop_nan_row</span><span class="p">:</span>
        <span class="n">coords</span><span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y_is_nonnan&#39;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">coords</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.run_posthoc_test_on_tick_hue_groups" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_posthoc_test_on_tick_hue_groups</span><span class="p">(</span><span class="n">ax_tick_data</span><span class="p">,</span> <span class="n">hue_group_1</span><span class="p">,</span> <span class="n">hue_group_2</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">hue_col_name</span><span class="p">,</span> <span class="n">value_cols_name</span><span class="p">,</span> <span class="n">test_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax_var_is_hue</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Run posthoc test on tick hue groups. Use existing dataframe filtered by the current axis levels, and perform stats on the hue groups.</p>
<p>Parameters:
ax_tick_data (pandas.DataFrame): The axis tick corresponding dataframe.
hue_group_1 (str): The first hue group.
hue_group_2 (str): The second hue group.
ax_category_level (str): The axis category level.
group_order (iterable): The order of the groups.
hue_col_name (str): The hue column name.
value_cols_name (str): The value column name.
test_name (str, optional): The name of the test. Defaults to 'MWU'.
ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</p>
<p>Returns:
dict: Dictionary with the posthoc test results.</p>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_posthoc_test_on_tick_hue_groups</span><span class="p">(</span><span class="n">ax_tick_data</span><span class="p">,</span> <span class="n">hue_group_1</span><span class="p">,</span> <span class="n">hue_group_2</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">,</span><span class="n">group_order</span><span class="p">,</span>
                                         <span class="n">hue_col_name</span><span class="p">,</span> <span class="n">value_cols_name</span><span class="p">,</span><span class="n">test_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">ax_var_is_hue</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Run posthoc test on tick hue groups. Use existing dataframe filtered by the current axis levels, and perform stats on the hue groups.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ax_tick_data (pandas.DataFrame): The axis tick corresponding dataframe.</span>
<span class="sd">    hue_group_1 (str): The first hue group.</span>
<span class="sd">    hue_group_2 (str): The second hue group.</span>
<span class="sd">    ax_category_level (str): The axis category level.</span>
<span class="sd">    group_order (iterable): The order of the groups.</span>
<span class="sd">    hue_col_name (str): The hue column name.</span>
<span class="sd">    value_cols_name (str): The value column name.</span>
<span class="sd">    test_name (str, optional): The name of the test. Defaults to &#39;MWU&#39;.</span>
<span class="sd">    ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: Dictionary with the posthoc test results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">##define test to run</span>
    <span class="k">if</span> <span class="n">test_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s1">&#39;MWU&#39;</span>
    <span class="c1">## extract groups from the dataframe containing data corresponding to the ax tick in question</span>
    <span class="c1"># ax_tick_data =plot_data.loc[plot_data[ax_grouping_col] ==  ax_category_level,:]</span>
    <span class="n">data_group_1</span><span class="o">=</span> <span class="n">ax_tick_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ax_tick_data</span><span class="p">[</span><span class="n">hue_col_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">hue_group_1</span><span class="p">,:]</span>
    <span class="n">data_group_2</span><span class="o">=</span> <span class="n">ax_tick_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ax_tick_data</span><span class="p">[</span><span class="n">hue_col_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">hue_group_2</span><span class="p">,:]</span>
    <span class="c1">## get values from each grup</span>
    <span class="n">data_group_1_values</span> <span class="o">=</span> <span class="n">data_group_1</span><span class="p">[</span><span class="n">value_cols_name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">data_group_2_values</span> <span class="o">=</span><span class="n">data_group_2</span><span class="p">[</span><span class="n">value_cols_name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="c1">## run stats on group values</span>
    <span class="n">result_dict</span> <span class="o">=</span> <span class="n">get_pair_stat_test_result</span><span class="p">(</span><span class="n">test_name</span><span class="p">,</span> <span class="n">ax_category_level</span><span class="p">,</span><span class="n">group_order</span><span class="p">,</span> <span class="n">hue_group_1</span><span class="p">,</span> <span class="n">hue_group_2</span><span class="p">,</span> <span class="n">data_group_1_values</span><span class="p">,</span><span class="n">data_group_2_values</span><span class="p">,</span><span class="n">ax_var_is_hue</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="plot_posthoc_test.plot_stat_annotate.run_posthoc_tests_on_all_ax_ticks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_posthoc_tests_on_all_ax_ticks</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">plot_obj</span><span class="p">,</span> <span class="n">comparison_list</span><span class="p">,</span> <span class="n">ax_grouping_col</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">hue_col_name</span><span class="p">,</span> <span class="n">value_col_name</span><span class="p">,</span> <span class="n">test_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax_var_is_hue</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Run posthoc tests on all axis ticks.</p>
<p>Parameters:
plot_data (pandas.DataFrame): The plot data.
plot_obj (seaborn.axisgrid.FacetGrid): The plot object.
comparison_list (list): List of comparisons.
ax_grouping_col (str): The column name for axis grouping.
group_order (iterable): The order of the groups.
hue_col_name (str): The hue column name.
value_col_name (str): The value column name.
test_name (str, optional): The name of the test. Defaults to 'MWU'.
ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</p>
<div class="highlight"><pre><span></span><code><span class="n">Returns</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="k">with</span> <span class="n">posthoc</span> <span class="n">test</span> <span class="n">results</span><span class="o">.</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>plot_posthoc_test\plot_stat_annotate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_posthoc_tests_on_all_ax_ticks</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">plot_obj</span><span class="p">,</span> <span class="n">comparison_list</span><span class="p">,</span> <span class="n">ax_grouping_col</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span> <span class="n">hue_col_name</span><span class="p">,</span> <span class="n">value_col_name</span><span class="p">,</span>
                                      <span class="n">test_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax_var_is_hue</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Run posthoc tests on all axis ticks.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    plot_data (pandas.DataFrame): The plot data.</span>
<span class="sd">    plot_obj (seaborn.axisgrid.FacetGrid): The plot object.</span>
<span class="sd">    comparison_list (list): List of comparisons.</span>
<span class="sd">    ax_grouping_col (str): The column name for axis grouping.</span>
<span class="sd">    group_order (iterable): The order of the groups.</span>
<span class="sd">    hue_col_name (str): The hue column name.</span>
<span class="sd">    value_col_name (str): The value column name.</span>
<span class="sd">    test_name (str, optional): The name of the test. Defaults to &#39;MWU&#39;.</span>
<span class="sd">    ax_var_is_hue (bool, optional): Whether the axis variable is the hue. Defaults to False.</span>

<span class="sd">        Returns: pandas.DataFrame: DataFrame with posthoc test results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">test_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s1">&#39;MWU&#39;</span>

    <span class="n">compare_stats_df</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#if the ax levels = the hue levels, don&#39;t filter the plot data by what ax group col you&#39;re on</span>
    <span class="k">if</span> <span class="n">ax_var_is_hue</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With axis variable == Hue variable:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">geno_pair</span> <span class="ow">in</span> <span class="n">comparison_list</span><span class="p">:</span> <span class="c1">#iterate over ex. (WT VEH to HET VEH), do stats on each</span>
            <span class="n">posthoc_output</span><span class="o">=</span> <span class="n">run_posthoc_test_on_tick_hue_groups</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span>
                                                                    <span class="n">geno_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">geno_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">geno_pair</span><span class="p">,</span><span class="n">group_order</span><span class="p">,</span>
                                                                    <span class="n">hue_col_name</span><span class="p">,</span> <span class="n">value_col_name</span><span class="p">,</span><span class="n">test_name</span> <span class="o">=</span> <span class="n">test_name</span><span class="p">,</span><span class="n">ax_var_is_hue</span> <span class="o">=</span> <span class="n">ax_var_is_hue</span><span class="p">)</span>
            <span class="n">compare_stats_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posthoc_output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
    <span class="c1">#iterate through the different categories to compare hue level values within</span>
        <span class="k">for</span> <span class="n">ax_category_level</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="p">[</span><span class="n">ax_grouping_col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>        <span class="c1"># print(ax_category_level)</span>
            <span class="k">for</span> <span class="n">geno_pair</span> <span class="ow">in</span> <span class="n">comparison_list</span><span class="p">:</span> <span class="c1">#iterate over ex. (WT VEH to HET VEH), do stats on each</span>
                <span class="n">posthoc_output</span><span class="o">=</span> <span class="n">run_posthoc_test_on_tick_hue_groups</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">plot_data</span><span class="p">[</span><span class="n">ax_grouping_col</span><span class="p">]</span> <span class="o">==</span>  <span class="n">ax_category_level</span><span class="p">,:],</span>
                                                                    <span class="n">geno_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">geno_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax_category_level</span><span class="p">,</span> <span class="n">group_order</span><span class="p">,</span>
                                                                    <span class="n">hue_col_name</span><span class="p">,</span> <span class="n">value_col_name</span><span class="p">,</span><span class="n">test_name</span> <span class="o">=</span> <span class="n">test_name</span><span class="p">)</span>
                <span class="n">compare_stats_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posthoc_output</span><span class="p">)</span>
    <span class="n">stat_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">compare_stats_df</span><span class="p">)</span>
    <span class="c1"># after producing stat result table, merge with df of x tick labels and their positions</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">ax_var_is_hue</span><span class="p">):</span><span class="c1">#transform list of xticklabels to pandas df and merge ## inserted 10.16.24- automerge the xticks</span>
        <span class="n">stat_table</span> <span class="o">=</span> <span class="n">stat_table</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">get_x_ticks_as_df</span><span class="p">(</span><span class="n">plot_obj</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()),</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s1">&#39;category_compared_within&#39;</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s1">&#39;tick_text&#39;</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">stat_table</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>